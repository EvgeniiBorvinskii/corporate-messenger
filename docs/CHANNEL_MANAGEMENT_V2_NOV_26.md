# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞–º–∏ - 26 –Ω–æ—è–±—Ä—è 2025 (v2)

## ‚úÖ –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞–Ω–∞–ª–∞

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞–Ω–∞–ª–∞ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å, –≤ –∫–∞–∫–æ–π –≤–∫–ª–∞–¥–∫–µ –æ–Ω –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è:

- **Home (Public Channels)** - –ø—É–±–ª–∏—á–Ω—ã–µ –∫–∞–Ω–∞–ª—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤—Å–µ–º
- **Team Chats** - –∫–æ–º–∞–Ω–¥–Ω—ã–µ —á–∞—Ç—ã –¥–ª—è –æ—Ç–¥–µ–ª–æ–≤
- **Voice Rooms** - –≥–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–Ω–∞—Ç—ã

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ù–∞–∂–º–∏—Ç–µ FAB –∫–Ω–æ–ø–∫—É (+) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞
2. –í —Å–∞–º–æ–º –≤–µ—Ä—Ö—É —Ñ–æ—Ä–º—ã –≤—ã–±–µ—Ä–∏—Ç–µ **"Display In"**
3. –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ —Ç—Ä—ë—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∏–∫–æ–Ω–∫–∞, —Ü–≤–µ—Ç, –¥–æ—Å—Ç—É–ø)
5. –ù–∞–∂–º–∏—Ç–µ "Create"

–ö–∞–Ω–∞–ª –ø–æ—è–≤–∏—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ**!

### 2. –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ —Å –∑–∞–ø—Ä–æ—Å–æ–º –ø–∞—Ä–æ–ª—è

–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤ —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–º.

**–ö–∞–∫ —É–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª:**
1. –ù–∞–π–¥–∏—Ç–µ –∫–∞–Ω–∞–ª –≤ —Å–ø–∏—Å–∫–µ
2. **–î–æ–ª–≥–æ –Ω–∞–∂–º–∏—Ç–µ** (long press) –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∫–∞–Ω–∞–ª–∞
3. –í –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **"–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª"**
4. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –¥–∏–∞–ª–æ–≥–µ:
   - –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
   - **–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å** –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
   - –ù–∞–∂–º–∏—Ç–µ **"–£–¥–∞–ª–∏—Ç—å"**
5. –ï—Å–ª–∏ –ø–∞—Ä–æ–ª—å –≤–µ—Ä–Ω—ã–π - –∫–∞–Ω–∞–ª –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ
- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã
- –¢–æ–ª—å–∫–æ Master –∞–∫–∫–∞—É–Ω—Ç—ã –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å –∫–∞–Ω–∞–ª—ã
- –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å = –æ—Ç–∫–∞–∑ –≤ —É–¥–∞–ª–µ–Ω–∏–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **create_channel_screen.dart**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `_selectedTab` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –î–æ–±–∞–≤–ª–µ–Ω —Å–ø–∏—Å–æ–∫ `_tabs` —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
   - –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `_buildTabSelector()` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ API –∫–∞–∫ –ø–æ–ª–µ `category`

2. **chats_tab_screen.dart**
   - –ú–µ—Ç–æ–¥ `_confirmDeleteChannel()` –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ –¥–∏–∞–ª–æ–≥ —Å –∑–∞–ø—Ä–æ—Å–æ–º –ø–∞—Ä–æ–ª—è
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å
   - –ú–µ—Ç–æ–¥ `_deleteChannel()` —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–æ–ª—å
   - API –≤—ã–∑–æ–≤ –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ POST `/api/channels/:id/delete` —Å –ø–∞—Ä–æ–ª–µ–º –≤ body
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

3. **api_service.dart**
   - –ú–µ—Ç–æ–¥ `delete()` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Map<String, dynamic>`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ DELETE –∑–∞–ø—Ä–æ—Å–æ–≤

### API –∏–∑–º–µ–Ω–µ–Ω–∏—è (—Ç—Ä–µ–±—É—é—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ):

1. **POST /api/channels**
   ```json
   {
     "name": "Channel Name",
     "description": "Description",
     "type": "text",
     "category": "home|chats|voice",  // –ù–û–í–û–ï –ü–û–õ–ï
     "icon": "standard:chat",
     "color": "#007AFF",
     "allowedRoles": ["sales", "service"],
     "allowedUsers": []
   }
   ```

2. **POST /api/channels/:id/delete** (–ù–û–í–´–ô –†–û–£–¢)
   ```json
   {
     "password": "user_password"
   }
   ```
   
   –ë—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–ª—å Master
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª –µ—Å–ª–∏ –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - –í–µ—Ä–Ω—É—Ç—å 403 –µ—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å

## üì± –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π "Home"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ–Ω –ø–æ—è–≤–∏–ª—Å—è –≤–æ –≤–∫–ª–∞–¥–∫–µ Home
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –µ–≥–æ –ù–ï–¢ –≤ Chats –∏ Voice

2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π "Team Chats"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ–Ω –ø–æ—è–≤–∏–ª—Å—è –≤–æ –≤–∫–ª–∞–¥–∫–µ Chats
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –µ–≥–æ –ù–ï–¢ –≤ Home –∏ Voice

3. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π "Voice Rooms"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ–Ω –ø–æ—è–≤–∏–ª—Å—è –≤–æ –≤–∫–ª–∞–¥–∫–µ Voice
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –µ–≥–æ –ù–ï–¢ –≤ Home –∏ Chats

### –¢–µ—Å—Ç 2: –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞

1. –î–æ–ª–≥–æ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π –∫–∞–Ω–∞–ª
2. –í—ã–±–µ—Ä–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª"
3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±–µ–∑ –ø–∞—Ä–æ–ª—è** - –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
4. **–í–≤–µ–¥–∏—Ç–µ –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å** - –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å"
5. **–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å** - –∫–∞–Ω–∞–ª –¥–æ–ª–∂–µ–Ω —É–¥–∞–ª–∏—Ç—å—Å—è
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–∞–Ω–∞–ª –ø—Ä–æ–ø–∞–ª –∏–∑ —Å–ø–∏—Å–∫–∞

### –¢–µ—Å—Ç 3: –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

1. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (–Ω–µ Master)
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–ª–≥–æ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–∞–Ω–∞–ª
3. –ú–µ–Ω—é –ù–ï –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–ª—è—Ç—å—Å—è (—Ç–æ–ª—å–∫–æ Master –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å)

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞–Ω–∞–ª –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ë—ç–∫–µ–Ω–¥ —Ä–æ—É—Ç `/api/channels/:id/delete` –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω
2. –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å
3. –ù–µ—Ç —Ä–æ–ª–∏ Master

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã Master (admin@lonestarcalgary.com)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±—ç–∫–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞–Ω–∞–ª—ã –≤—Å—ë –µ—â—ë —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ Home

**–ü—Ä–∏—á–∏–Ω–∞:** –ë—ç–∫–µ–Ω–¥ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–µ `category`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ POST –∑–∞–ø—Ä–æ—Å–µ –µ—Å—Ç—å –ø–æ–ª–µ `category`
3. –û–±–Ω–æ–≤–∏—Ç–µ –±—ç–∫–µ–Ω–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## üìã TODO –¥–ª—è –±—ç–∫–µ–Ω–¥–∞

### 1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ category –≤ –º–æ–¥–µ–ª—å Channel
```javascript
const channel = {
  id: generateId(),
  name: req.body.name,
  description: req.body.description,
  type: req.body.type,
  category: req.body.category || 'home', // NEW
  icon: req.body.icon,
  color: req.body.color,
  allowedRoles: req.body.allowedRoles || [],
  allowedUsers: req.body.allowedUsers || [],
  created_at: new Date(),
};
```

### 2. –°–æ–∑–¥–∞—Ç—å —Ä–æ—É—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å –ø–∞—Ä–æ–ª–µ–º
```javascript
app.post('/api/channels/:id/delete', authenticate, async (req, res) => {
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–ª—å Master
  if (!req.user.roles.includes('master')) {
    return res.status(403).json({ error: 'Only Master can delete channels' });
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å
  const { password } = req.body;
  const isPasswordCorrect = await checkPassword(req.user.id, password);
  
  if (!isPasswordCorrect) {
    return res.status(403).json({ error: 'Incorrect password' });
  }
  
  // –£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª
  const { id } = req.params;
  delete channels[id];
  
  res.json({ message: 'Channel deleted successfully', channelId: id });
});
```

### 3. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ GET /api/channels
```javascript
app.get('/api/channels', authenticate, (req, res) => {
  const allChannels = Object.values(channels);
  
  // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å query –ø–∞—Ä–∞–º–µ—Ç—Ä ?category=home
  const { category } = req.query;
  
  let filtered = allChannels;
  if (category) {
    filtered = filtered.filter(ch => ch.category === category);
  }
  
  res.json({ channels: filtered });
});
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø–∞—Ä–æ–ª–µ–º
3. ‚è≥ –û–±–Ω–æ–≤–∏—Ç—å –±—ç–∫–µ–Ω–¥ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
4. ‚è≥ –û–±–Ω–æ–≤–∏—Ç—å –±—ç–∫–µ–Ω–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏
5. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤

---

**–í–µ—Ä—Å–∏—è**: Alpha 0.28  
**–î–∞—Ç–∞**: 26 –Ω–æ—è–±—Ä—è 2025  
**–†–∞–∑–º–µ—Ä**: 77.7 MB  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
