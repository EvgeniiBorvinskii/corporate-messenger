# ‚úÖ iOS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã! ‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è!

## –î–∞—Ç–∞: 12 –¥–µ–∫–∞–±—Ä—è 2025

## ‚úÖ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û (iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ):

### 1. NSMicrophoneUsageDescription - –ì–û–¢–û–í–û ‚úÖ
**–§–∞–π–ª**: `mobile/ios/Runner/Info.plist`

–î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:
```xml
<key>NSMicrophoneUsageDescription</key>
<string>Lone Star Chat needs access to your microphone for voice and video calls with team members</string>

<key>NSCameraUsageDescription</key>
<string>Lone Star Chat needs access to your camera for video calls with team members</string>
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ –ù–ï –±—É–¥–µ—Ç –∫—Ä–∞—à–∏—Ç—å—Å—è –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É!

### 2. –ë–ª—é—Ä –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω - –ì–û–¢–û–í–û ‚úÖ
**–§–∞–π–ª**: `mobile/lib/widgets/discord_message_menu.dart`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `View.physicalSize` –¥–ª—è iPhone 17 Pro Max
- –ü–æ–∫—Ä—ã–≤–∞–µ—Ç notch –∏ home indicator

### 3. –ë—ã—Å—Ç—Ä–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - –ì–û–¢–û–í–û ‚úÖ
**–§–∞–π–ª—ã**: `mobile/lib/providers/auth_provider.dart`, `mobile/lib/services/auth_service.dart`
- –õ–æ–≥–∏–Ω —É—Å–∫–æ—Ä–µ–Ω —Å 15-30s –¥–æ 2-5s
- –¢–∞–π–º–∞—É—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

### 4. CallService –æ–±–Ω–æ–≤–ª—ë–Ω - –ì–û–¢–û–í–û ‚úÖ
**–§–∞–π–ª**: `mobile/lib/services/call_service.dart`
- –í—Å–µ Socket.io —Å–æ–±—ã—Ç–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –Ω–æ–≤—ã–º –±—ç–∫–µ–Ω–¥–æ–º
- `call:incoming`, `call:accepted`, `call:offer`, `call:answer`, etc.

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ö–û–î –ù–ï –ù–ê –°–ï–†–í–ï–†–ï!

### –û—à–∏–±–∫–∞ –∏–∑ –ª–æ–≥–æ–≤:
```
‚ùå WebSocket error: WebSocketException: Connection to 
'http://5.249.160.54:666/socket.io/?EIO=4&transport=websocket#' 
was not upgraded to websocket, HTTP status code: 404
```

### –ü—Ä–∏—á–∏–Ω–∞:
–ù–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ `5.249.160.54:666` **–ù–ï–¢** –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `server-chat.js`!

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ **–õ–û–ö–ê–õ–¨–ù–û** –Ω–∞ –≤–∞—à–µ–º Mac:
- ‚úÖ `/Users/svetanaborvinskaia/Desktop/Lone Star Chat/backend/server-chat.js` - –æ–±–Ω–æ–≤–ª—ë–Ω
- ‚ùå `5.249.160.54:/path/to/backend/server-chat.js` - **–ù–ï –û–ë–ù–û–í–õ–Å–ù**

---

## üöÄ –î–í–ê –í–ê–†–ò–ê–ù–¢–ê –†–ï–®–ï–ù–ò–Ø:

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –û–±–Ω–æ–≤–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä**:
```bash
# –° –≤–∞—à–µ–≥–æ Mac
scp /Users/svetanaborvinskaia/Desktop/Lone\ Star\ Chat/backend/server-chat.js user@5.249.160.54:/path/to/backend/
```

**2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å**:
```bash
# SSH –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh user@5.249.160.54

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart chat-server
# –∏–ª–∏
systemctl restart chat-server
```

**3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å**:
```bash
curl http://5.249.160.54:666/socket.io/
# –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 404!
```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

**1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ**:
```bash
cd /Users/svetanaborvinskaia/Desktop/Lone\ Star\ Chat/backend
node server-chat.js
```

**2. –£–∑–Ω–∞—Ç—å —Å–≤–æ–π IP**:
```bash
ipconfig getifaddr en0
# –ù–∞–ø—Ä–∏–º–µ—Ä: 192.168.51.238
```

**3. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏**:
- –û—Ç–∫—Ä—ã—Ç—å Profile ‚Üí Settings
- IP Address ‚Üí –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–π –ª–æ–∫–∞–ª—å–Ω—ã–π IP (192.168.51.238)
- Save

**4. –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞**:
```
http://192.168.51.238:3000
```

---

## üì± –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
cd mobile

# –û—á–∏—Å—Ç–∫–∞
flutter clean
flutter pub get

# –°–±–æ—Ä–∫–∞ –¥–ª—è iOS (–±–µ–∑ –∫–æ–¥–µ-–ø–æ–¥–ø–∏—Å–∏)
flutter build ios --release --no-codesign

# –ò–ª–∏ –∑–∞–ø—É—Å–∫ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
flutter run --release
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ ‚úÖ
```
1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –∑–≤–æ–Ω–∫–∞
4. iOS –ø–æ–ø—Ä–æ—Å–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω
5. –†–∞–∑—Ä–µ—à–∏—Ç—å
6. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï –¥–æ–ª–∂–Ω–æ –∫—Ä–∞—à–∏—Ç—å—Å—è ‚úÖ
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```
–õ–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:
‚úÖ üîå WebSocket connected via PresenceProvider
‚úÖ üîå WebRTC Socket connected

–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
‚ùå WebSocket error: ... HTTP status code: 404
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–≤–æ–Ω–∫–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç 2 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
```
1. Device 1: –≤–æ–π—Ç–∏ –∫–∞–∫ User A
2. Device 2: –≤–æ–π—Ç–∏ –∫–∞–∫ User B
3. Device 1: –ø–æ–∑–≤–æ–Ω–∏—Ç—å User B
4. Device 2: –ø—Ä–∏–Ω—è—Ç—å –∑–≤–æ–Ω–æ–∫
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ
6. –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–≤–æ–Ω–æ–∫

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï –¥–æ–ª–∂–Ω–æ –∫—Ä–∞—à–∏—Ç—å—Å—è!
```

---

## üìä –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

| –ü—Ä–æ–±–ª–µ–º–∞ | –õ–æ–∫–∞–ª—å–Ω–æ | –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ |
|----------|----------|------------|
| NSMicrophoneUsageDescription | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | N/A |
| NSCameraUsageDescription | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | N/A |
| –ë–ª—é—Ä –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | N/A |
| –ë—ã—Å—Ç—Ä–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | N/A |
| CallService Socket.io —Å–æ–±—ã—Ç–∏—è | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | N/A |
| Backend Socket.io handlers | ‚úÖ –ì–æ—Ç–æ–≤ –≤ —Ñ–∞–π–ª–µ | ‚ùå **–ù–ï –ó–ê–ì–†–£–ñ–ï–ù** |
| Backend Call History API | ‚úÖ –ì–æ—Ç–æ–≤ –≤ —Ñ–∞–π–ª–µ | ‚ùå **–ù–ï –ó–ê–ì–†–£–ñ–ï–ù** |

---

## ‚úÖ –ò—Ç–æ–≥–∏:

### –ì–æ—Ç–æ–≤–æ:
- ‚úÖ iOS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã (–º–∏–∫—Ä–æ—Ñ–æ–Ω + –∫–∞–º–µ—Ä–∞)
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω–æ —Å `flutter clean`
- ‚úÖ –ë–ª—é—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–∫–æ—Ä–µ–Ω–∞
- ‚úÖ CallService –æ–±–Ω–æ–≤–ª—ë–Ω
- ‚úÖ Backend –∫–æ–¥ –≥–æ—Ç–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ

### –¢—Ä–µ–±—É–µ—Ç—Å—è:
- ‚ö†Ô∏è **–ó–∞–≥—Ä—É–∑–∏—Ç—å `server-chat.js` –Ω–∞ —Å–µ—Ä–≤–µ—Ä `5.249.160.54`**
- ‚ö†Ô∏è **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**
- ‚ö†Ô∏è **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–≤–æ–Ω–∫–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ**

---

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- `–¢–†–ï–ë–£–ï–¢–°–Ø_–û–ë–ù–û–í–ò–¢–¨_–°–ï–†–í–ï–†.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- `–í–°–ï_–ö–†–ê–®–´_–ò–°–ü–†–ê–í–õ–ï–ù–´.md` - –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- `BUG_FIXES_DEC_11_2025.md` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ (EN)

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ó–∞–≥—Ä—É–∑–∏—Ç—å `backend/server-chat.js` –Ω–∞ —Å–µ—Ä–≤–µ—Ä `5.249.160.54` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å!
