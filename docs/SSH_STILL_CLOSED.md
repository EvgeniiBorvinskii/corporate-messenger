# üîí SSH –ü–æ—Ä—Ç –≤—Å–µ –µ—â–µ –∑–∞–∫—Ä—ã—Ç - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ç–∫—Ä—ã—Ç–∏—é

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 10 –¥–µ–∫–∞–±—Ä—è 2025, 04:28 GMT  
**–°–µ—Ä–≤–µ—Ä:** 5.249.160.54  
**–°—Ç–∞—Ç—É—Å SSH:** ‚ùå Connection refused (–ø–æ—Ä—Ç 22 –∑–∞–∫—Ä—ã—Ç)  
**–°—Ç–∞—Ç—É—Å HTTP:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (nginx/1.18.0)

---

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:

SSH –ø–æ—Ä—Ç 22 –≤—Å–µ –µ—â–µ –∑–∞–∫—Ä—ã—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.  
–ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø–æ—Ä—Ç—ã: 22, 2222, 22022, 2200, 8022 - –≤—Å–µ –∑–∞–∫—Ä—ã—Ç—ã.

```bash
$ ssh root@5.249.160.54
ssh: connect to host 5.249.160.54 port 22: Connection refused
```

---

## üîì –†–µ—à–µ–Ω–∏–µ 1: –û—Ç–∫—Ä—ã—Ç—å SSH —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞

### –®–∞–≥ 1: –í–æ–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–û–±—ã—á–Ω–æ —ç—Ç–æ –æ–¥–∏–Ω –∏–∑:
- ISPmanager: `http://5.249.160.54:1500`
- cPanel: `http://5.249.160.54:2083`
- Plesk: `http://5.249.160.54:8443`
- VestaCP: `http://5.249.160.54:8083`
- DirectAdmin: `http://5.249.160.54:2222`

### –®–∞–≥ 2: –ù–∞–π—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Firewall

**–í ISPmanager:**
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–°–µ—Ä–≤–µ—Ä" ‚Üí "–ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä"
2. –ù–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è SSH (–ø–æ—Ä—Ç 22)
3. –í–∫–ª—é—á–∏—Ç—å/—Ä–∞–∑—Ä–µ—à–∏—Ç—å

**–í –¥—Ä—É–≥–∏—Ö –ø–∞–Ω–µ–ª—è—Ö:**
1. Security ‚Üí Firewall
2. Network ‚Üí Firewall Rules
3. –ù–∞–π—Ç–∏ SSH (port 22) –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å

### –®–∞–≥ 3: –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 22

**–ß–µ—Ä–µ–∑ ufw (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**
```bash
ufw allow 22/tcp
ufw reload
```

**–ß–µ—Ä–µ–∑ iptables:**
```bash
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
service iptables save
```

**–ß–µ—Ä–µ–∑ firewalld:**
```bash
firewall-cmd --permanent --add-service=ssh
firewall-cmd --reload
```

---

## üñ•Ô∏è –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞

–ú–Ω–æ–≥–∏–µ —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –≤–µ–±-—Ç–µ—Ä–º–∏–Ω–∞–ª.

### –ö–∞–∫ –Ω–∞–π—Ç–∏ –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å:

1. **ISPmanager:** –°–µ—Ä–≤–µ—Ä ‚Üí –¢–µ—Ä–º–∏–Ω–∞–ª
2. **cPanel:** Advanced ‚Üí Terminal
3. **Plesk:** Tools & Settings ‚Üí Terminal
4. **VestaCP:** Server ‚Üí Console

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –≤–µ–±-–∫–æ–Ω—Å–æ–ª–∏:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ SSH –∑–∞–ø—É—â–µ–Ω
systemctl status sshd

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å SSH –µ—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω
systemctl start sshd
systemctl enable sshd

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall
iptables -L -n | grep 22

# 4. –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 22
ufw allow 22/tcp
# –∏–ª–∏
iptables -I INPUT -p tcp --dport 22 -j ACCEPT
iptables-save > /etc/iptables/rules.v4

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
systemctl restart sshd
ufw reload
```

---

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ 3: –†—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ File Manager

–ï—Å–ª–∏ SSH –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞:

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å File Manager –≤ –ø–∞–Ω–µ–ª–∏ —Ö–æ—Å—Ç–∏–Ω–≥–∞

### –®–∞–≥ 2: –ù–∞–π—Ç–∏ `/root/server-chat.js`

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø

–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –≤ `server-chat.js.backup-20251210`

### –®–∞–≥ 4: –ù–∞–π—Ç–∏ endpoint —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤

–ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É (–ø—Ä–∏–º–µ—Ä–Ω–æ 500-600):
```javascript
app.post('/api/channels', authenticateToken, async (req, res) => {
```

### –®–∞–≥ 5: –ù–∞–π—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ newChannel

–ù–∞–π—Ç–∏ –∫–æ–¥:
```javascript
const newChannel = {
  id: generateId(),
  name,
  description: description || '',
  type,
  created_at: new Date().toISOString(),
  created_by: req.user.userId
};
```

### –®–∞–≥ 6: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ category

–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞:
```javascript
const newChannel = {
  id: generateId(),
  name,
  description: description || '',
  type,
  category: req.body.category || 'chats', // ‚≠ê –î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£
  created_at: new Date().toISOString(),
  created_by: req.user.userId
};
```

### –®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–∞–Ω–µ–ª–∏ —Ö–æ—Å—Ç–∏–Ω–≥–∞:
```bash
pm2 restart server-chat
# –∏–ª–∏
systemctl restart chat-backend
```

---

## üîç –†–µ—à–µ–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API

–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–æ–±–∞–≤–∏—Ç—å endpoint —á–µ—Ä–µ–∑ HTTP API (–µ—Å–ª–∏ –µ—Å—Ç—å –∞–¥–º–∏–Ω—Å–∫–∏–π –¥–æ—Å—Ç—É–ø).

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `update-backend.sh`:
```bash
#!/bin/bash
curl -X POST http://5.249.160.54/api/admin/update-code \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "file": "server-chat.js",
    "action": "patch",
    "code": "category: req.body.category || '\''chats'\''"
  }'
```

---

## ‚úÖ –ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è SSH:

–ö–æ–≥–¥–∞ SSH –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
ssh root@5.249.160.54
# –ü–∞—Ä–æ–ª—å: 54654250pS3123

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
cd "/Users/svetanaborvinskaia/Desktop/Lone Star Chat"
scp add_missing_endpoints.js root@5.249.160.54:/root/

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@5.249.160.54
node add_missing_endpoints.js

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
pm2 restart server-chat

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
curl http://5.249.160.54/api/channels \
  -H "Authorization: Bearer TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"Test","type":"text","category":"voice"}'
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

–ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å SSH —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ:

1. **–£–∑–Ω–∞—Ç—å —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:**
   ```bash
   whois 5.249.160.54
   ```

2. **–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É:**
   - "Please open SSH port 22 for IP 5.249.160.54"
   - "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ SSH –ø–æ—Ä—Ç 22"

3. **–û–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:** 10-30 –º–∏–Ω—É—Ç

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

**–°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±:**
1. –í–æ–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö–æ—Å—Ç–∏–Ω–≥–æ–º
2. –û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–∫–æ–Ω—Å–æ–ª—å (Terminal)
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏–∑ "–†–µ—à–µ–Ω–∏—è 2"
4. –í—Ä—É—á–Ω—É—é –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `server-chat.js` (–†–µ—à–µ–Ω–∏–µ 3)

**–í—Ä–µ–º—è:** ~15 –º–∏–Ω—É—Ç

---

**–î–∞—Ç–∞:** 10 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è SSH  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
