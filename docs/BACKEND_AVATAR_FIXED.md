# ‚úÖ BACKEND –ò–°–ü–†–ê–í–õ–ï–ù - –ê–í–ê–¢–ê–†–´ –ò NEWS

## üéØ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û:

### 1Ô∏è‚É£ –ò–°–ü–†–ê–í–õ–ï–ù API `/api/users` 
**–ü—Ä–æ–±–ª–µ–º–∞:** API –Ω–µ –æ—Ç–¥–∞–≤–∞–ª –ø–æ–ª–µ `avatar_url`
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –≤ –æ—Ç–≤–µ—Ç

```javascript
// –î–û:
const userList = Object.values(users).map(u => ({
  id: u.id,
  email: u.email,
  // avatar_url –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª! ‚ùå
}));

// –ü–û–°–õ–ï:
const userList = Object.values(users).map(u => ({
  id: u.id,
  email: u.email,
  avatar_url: u.avatar_url,  // ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û!
}));
```

### 2Ô∏è‚É£ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ê –ó–ê–ì–†–£–ó–ö–ê –ê–í–ê–¢–ê–†–û–í
**–ë—ã–ª–æ:** –ó–∞–≥–ª—É—à–∫–∞, –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ `success: false`
**–°—Ç–∞–ª–æ:** –ù–∞—Å—Ç–æ—è—â–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å `multer`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- üìÅ –ê–≤–∞—Ç–∞—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/root/lonestar-chat/backend/uploads/avatars/`
- üîí –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: 5MB, —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ (jpeg, jpg, png, gif, webp)
- üóëÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ
- üåê URL: `http://5.249.160.54:3002/uploads/avatars/user_1_1234567890.jpg`

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:**
```json
{
  "success": true,
  "message": "Avatar uploaded successfully",
  "avatar_url": "/uploads/avatars/user_1_1234567890.jpg",
  "user": {
    "id": "1",
    "email": "admin@lonestar.local",
    "full_name": "Master Administrator",
    "avatar_url": "/uploads/avatars/user_1_1234567890.jpg"
  }
}
```

### 3Ô∏è‚É£ –ü–†–û–í–ï–†–ï–ù–û: NEWS –ö–ê–ù–ê–õ –°–£–©–ï–°–¢–í–£–ï–¢
```bash
curl http://5.249.160.54:3002/api/channels -H "Authorization: Bearer TOKEN"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Total channels: 6
  1. News (type: public, id: news)        ‚úÖ –ï–°–¢–¨!
  2. Administrators (type: private)
  3. Sales (type: private)
  4. Service (type: private)
  5. Parts (type: private)
  6. Lot Team (type: private)
```

---

## üì± –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –í –ü–†–ò–õ–û–ñ–ï–ù–ò–ò:

### –®–ê–ì 1: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ü–û–ß–ï–ú–£ –≠–¢–û –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
- –°—Ç–∞—Ä—ã–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É News
- –°—Ç–∞—Ä–∞—è –º–æ–¥–µ–ª—å User –º–æ–∂–µ—Ç –Ω–µ –∏–º–µ—Ç—å –ø–æ–ª—è `avatar_url`
- –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º

**–ö–ê–ö –°–î–ï–õ–ê–¢–¨:**

1. **–£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å iPhone:**
   - –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - "–£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" ‚Üí "–£–¥–∞–ª–∏—Ç—å"

2. **–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à Flutter:**
```bash
cd "/Users/svetanaborvinskaia/Desktop/Lone Star Chat/mobile"
flutter clean
flutter pub get
```

3. **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:**
```bash
flutter run -d 00008150-001229522280401C
```

### –®–ê–ì 2: –í–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ

- Email: `admin`
- Password: `admin`

**–í–ê–ñ–ù–û:** –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (—ç—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞–Ω–µ–µ)

### –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å News –∫–∞–Ω–∞–ª

1. –û—Ç–∫—Ä–æ–π –≤–∫–ª–∞–¥–∫—É "–ì–ª–∞–≤–Ω–∞—è" (Home)
2. **News –î–û–õ–ñ–ï–ù –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ!**
3. –ï—Å–ª–∏ –Ω–µ—Ç - —Å–º–æ—Ç—Ä–∏ –∫–æ–Ω—Å–æ–ª—å –∏ –ø—Ä–∏—à–ª–∏ –º–Ω–µ –ª–æ–≥–∏:

```
flutter: üîç DEBUG: Received X channels from API
flutter: üì¢ Channel: "News" (type: public, id: news)
flutter: ‚úÖ SHOWING NEWS CHANNEL!  <-- –≠–¢–û –î–û–õ–ñ–ù–û –ë–´–¢–¨!
```

### –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∞–≤–∞—Ç–∞—Ä–∞

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ü—Ä–æ—Ñ–∏–ª—å
2. –ù–∞–∂–º–∏ –Ω–∞ –∞–≤–∞—Ç–∞—Ä –∏–ª–∏ –∫–Ω–æ–ø–∫—É "–ó–∞–≥—Ä—É–∑–∏—Ç—å"
3. –í—ã–±–µ—Ä–∏ —Ñ–æ—Ç–æ
4. **–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è:**
   - ‚úÖ "–ê–≤—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω"
   - ‚úÖ –§–æ—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
   - ‚úÖ –§–æ—Ç–æ –≤–∏–¥–Ω–æ –≤ —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢:

### –ï—Å–ª–∏ News –Ω–µ –ø–æ—è–≤–∏–ª—Å—è:

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ Flutter**

–ò—â–∏ —Å—Ç—Ä–æ–∫–∏:
```
flutter: üîç DEBUG: Received X channels from API
flutter: üì¢ Channel: "News" (type: public, id: news)
```

**–ï—Å–ª–∏ –∫–∞–Ω–∞–ª –ø—Ä–∏—Ö–æ–¥–∏—Ç, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
- –ü—Ä–∏—à–ª–∏ –º–Ω–µ –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏

**–ï—Å–ª–∏ –∫–∞–Ω–∞–ª –ù–ï –ø—Ä–∏—Ö–æ–¥–∏—Ç:**
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–æ–∫–µ–Ω–æ–º (401 –æ—à–∏–±–∫–∞)
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤–æ—à–µ–ª –∑–∞–Ω–æ–≤–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –ï—Å–ª–∏ –∞–≤–∞—Ç–∞—Ä –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:

**–ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å Flutter:**
```
flutter: üì§ Request: POST /api/users/1/avatar
flutter: üì• Response: XXX
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** 200 –∏–ª–∏ 201
**–ï—Å–ª–∏ 404:** Backend –Ω–µ –æ–±–Ω–æ–≤–∏–ª—Å—è
**–ï—Å–ª–∏ 401:** –¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π, –ø–µ—Ä–µ–ª–æ–≥–∏–Ω—å—Å—è
**–ï—Å–ª–∏ 400:** –§–∞–π–ª –Ω–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

---

## üéØ –ò–¢–û–ì–û–í–´–ô –ß–ï–ö–õ–ò–°–¢:

- [ ] –£–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å iPhone
- [ ] `flutter clean && flutter pub get`
- [ ] `flutter run -d 00008150-001229522280401C`
- [ ] –í–æ–π—Ç–∏ –∫–∞–∫ admin/admin
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: News –≤ —Å–ø–∏—Å–∫–µ –∫–∞–Ω–∞–ª–æ–≤?
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ê–≤–∞—Ç–∞—Ä –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è?
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è?

**–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø—Ä–∏—à–ª–∏ –º–Ω–µ:
1. –õ–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ Flutter (—Å—Ç—Ä–æ–∫–∏ —Å `flutter: üîç DEBUG`)
2. –°–∫—Ä–∏–Ω—à–æ—Ç –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
3. –°–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∞–≤–∞—Ç–∞—Ä–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

## üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° BACKEND:

‚úÖ Backend –∑–∞–ø—É—â–µ–Ω: –ø—Ä–æ—Ü–µ—Å—Å 914354
‚úÖ API /api/users –æ—Ç–¥–∞–µ—Ç avatar_url
‚úÖ API /api/channels –æ—Ç–¥–∞–µ—Ç News –∫–∞–Ω–∞–ª
‚úÖ Endpoint /api/users/:userId/avatar —Ä–∞–±–æ—Ç–∞–µ—Ç —Å multer
‚úÖ –ü–∞–ø–∫–∞ /root/lonestar-chat/backend/uploads/avatars —Å–æ–∑–¥–∞–Ω–∞
‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã —Ä–∞–∑–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ /uploads

**–í—Å–µ –≥–æ—Ç–æ–≤–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ backend!** –¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
